/* global L, console, foursq_client_id, foursq_client_secret, zooms*/(function(){function r(){console.log("showing_markers");console.log(n);$.each(n,function(t,n){console.log(n);e.getBounds().contains(n.getLatLng())?e.addLayer(n):e.removeLayer(n)})}function i(e){var r=new L.marker([e.location.lat,e.location.lng],{title:e.name});if(t.indexOf(e.id)<=-1){t.push(e.id);n.push(r)}}function s(e){console.log("not implemented yet! - showError "+e)}function o(e){s(e)}function u(){console.log("not implemented yet! - onLocationFound")}function a(){var t=e.getCenter(),n=t.lat+","+t.lng,s=Math.max(e.getSize().x,e.getSize().y),o=e.getZoom(),u=zooms[o]*s;$.getJSON("https://api.foursquare.com/v2/venues/search",{ll:n,radius:u,limit:50,intent:"checkin",categoryId:"4bf58dd8d48988d155941735,4bf58dd8d48988d11b941735,4d4b7105d754a06376d81259",client_id:foursq_client_id,client_secret:foursq_client_secret,v:20130420}).done(function(e){$.each(e.response.venues,function(e,t){i(t)});r()});r()}function f(){var t="http://{s}.tile.cloudmade.com/364b324514d240c8afdd7ba132fd4841/997/256/{z}/{x}/{y}.png",n="Map data Â© OpenStreetMap contributors",r=new L.TileLayer(t,{minZoom:8,maxZoom:18,attribution:n});e.addLayer(r);e.locate({setView:!0,maxZoom:17});e.on("locationerror",o);e.on("locationfound",u);e.on("moveend",a)}var e=L.map("map"),t=[],n=[];f()})();